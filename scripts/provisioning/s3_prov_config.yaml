#
# Copyright (c) 2020 Seagate Technology LLC and/or its Affiliates
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# For any questions about this software or licensing,
# please email opensource@seagate.com or cortx-questions@seagate.com.
#
# All the phases involved in setting up s3 server, irrespective of which
# provisioner keys they use, must need to follow inheritance hierarchy. This
# means any key used in a certain phase must be validated for all successive
# phases. This basis for validating provisioner keys should be strictly
# followed, or else will break the validation logic. The hierarchy
# ends with the last phase of s3 setup and the remaining phases will
# only be used for test, reset or cleanup. Unsolicited keys which are
# not used in the setup phases should be added to the bottom of the file.
# Also note, there are 3 token-strings used in this file :
# "machine-id"- used to substitute machine id of the node
# "cluster-id"- used to substitute cluster id of the setup, not to be confused
#               with cluster_id which is component of a key.
# "storage-set-count"- storage set count, not to be confused with
#                      storage_set_count which is component of a key.

POST_INSTALL:
PREPARE:
CONFIG:
  CONFSTORE_LDAPADMIN_USER_KEY: "cortx>software>openldap>sgiam>user"
  CONFSTORE_LDAPADMIN_PASSWD_KEY: "cortx>software>openldap>sgiam>secret"
  CONFSTORE_ROOTDN_USER_KEY: "cortx>software>openldap>root>user"
  CONFSTORE_ROOTDN_PASSWD_KEY: "cortx>software>openldap>root>secret"
  CONFSTORE_S3_MOTR_MAX_UNITS_PER_REQUEST : "cortx>software>s3>io>max_units"
  CONFSTORE_CLUSTER_ID_KEY: "server_node>machine-id>cluster_id"
  CONFSTORE_S3INSTANCES_KEY: "cortx>software>s3>service>instances"
  CONFSTORE_HOSTNAME_KEY: "server_node>machine-id>hostname"
  CONFSTORE_STORAGE_SET_COUNT_KEY: "cluster>cluster-id>site>storage_set_count"
  CONFSTORE_STORAGE_SET_SERVER_NODES_KEY: "cluster>cluster-id>storage_set[storage-set-count]>server_nodes"
  CONFSTORE_PUBLIC_FQDN_KEY: "server_node>machine-id>network>data>public_fqdn"
  CONFSTORE_PRIVATE_FQDN_KEY: "server_node>machine-id>network>data>private_fqdn"

  CONFSTORE_S3SERVER_PORT: "cortx>software>s3>service>s3server_port"
  CONFSTORE_S3_SERVER_BGDELETE_BIND_PORT: "cortx>software>s3>service>s3_server_bgdelete_bind_port"
  CONFSTORE_S3_AUTHSERVER_IP_ADDRESS: "cortx>software>s3>service>authserver_ip_address"
  CONFSTORE_S3_AUTHSERVER_PORT: "cortx>software>s3>service>authserver_port"
  CONFSTORE_S3_ENABLE_STATS: "cortx>software>s3>service>s3_enable_stats"
  CONFSTORE_S3_AUDIT_LOGGER: "cortx>software>s3>service>s3_audit_logger"

  CONFSTORE_S3_AUTHSERVER_HTTP_PORT: "cortx>software>s3authserver>httpPort"
  CONFSTORE_S3_AUTHSERVER_HTTPS_PORT: "cortx>software>s3authserver>httpsPort"
  CONFSTORE_S3_AUTHSERVER_LDAP_HOST: "cortx>software>s3authserver>ldapHost"
  CONFSTORE_S3_AUTHSERVER_LDAP_PORT: "cortx>software>s3authserver>ldapPort"
  CONFSTORE_S3_AUTHSERVER_LDAP_SSL_PORT: "cortx>software>s3authserver>ldapSSLPort"
  CONFSTORE_S3_AUTHSERVER_DEFAULT_ENDPOINT: "cortx>software>s3authserver>defaultEndpoint"
  CONFSTORE_S3_AUTHSERVER_IAM_AUDITLOG: "cortx>software>s3authserver>iamAuditLog"

  CONFSTORE_S3_BGDELETE_ENDPOINT: "cortx>software>s3bgdelete>endpoint"
  CONFSTORE_S3_BGDELETE_PORT: "cortx>software>s3bgdelete>port"
  CONFSTORE_S3_BGDELETE_SCHEDULER_SCHEDULE_INTERVAL: "cortx>software>s3bgdelete>scheduler_schedule_interval"
  CONFSTORE_S3_BGDELETE_MAX_KEYS: "cortx>software>s3bgdelete>max_keys"

  CONFSTORE_BASE_LOG_PATH: "cortx>software>base_log_path"
  CONFSTORE_BASE_CONFIG_PATH: "cortx>software>base_config_path"
  CONFSTORE_SHARED_BASE_LOG_PATH: "cortx>software>shared_base_log_path"
  CONFSTORE_SHARED_BASE_CONFIG_PATH: "cortx>software>shared_base_config_path"
INIT:
# Inheritance hierarchy ends here.

TEST:
  TEST_CONFSTORE_LDAPADMIN_USER_KEY: "test>s3>iam_username"
  TEST_CONFSTORE_LDAPADMIN_PASSWD_KEY: "test>s3>iam_password"
  TEST_CONFSTORE_ENDPOINT_KEY: "test>s3>endpoint_url"


# Unsolicited Keys should be added to the bottom.
LDAP_USER: "cn={},dc=seagate,dc=com"
LDAP_URL: "ldapi:///"
CONFSTORE_OPENLDAP_CONST_KEY: "cortx"
CONFSTORE_SITE_COUNT_KEY: "cluster>cluster-id>site_count"
S3_CONFIG_FILE: "/opt/seagate/cortx/s3/conf/s3config.yaml"
S3_CONFIG_SAMPLE_FILE: "/opt/seagate/cortx/s3/conf/s3config.yaml.sample"
S3_CONFIG_UNSAFE_ATTR_FILE: "/opt/seagate/cortx/s3/conf/s3config_unsafe_attributes.yaml"
S3_AUTHSERVER_RESOURCES_DIR: "/opt/seagate/cortx/auth/resources/"
S3_AUTHSERVER_CONFIG_FILE: "/opt/seagate/cortx/auth/resources/authserver.properties"
S3_AUTHSERVER_CONFIG_SAMPLE_FILE: "/opt/seagate/cortx/auth/resources/authserver.properties.sample"
S3_AUTHSERVER_CONFIG_UNSAFE_ATTR_FILE: "/opt/seagate/cortx/auth/resources/authserver_unsafe_attributes.properties"
S3_KEYSTORE_CONFIG_FILE: "/opt/seagate/cortx/auth/resources/keystore.properties"
S3_KEYSTORE_CONFIG_SAMPLE_FILE: "/opt/seagate/cortx/auth/resources/keystore.properties.sample"
S3_KEYSTORE_CONFIG_UNSAFE_ATTR_FILE: "/opt/seagate/cortx/auth/resources/keystore_unsafe_attributes.properties"
S3_BGDELETE_CONFIG_FILE: "/opt/seagate/cortx/s3/s3backgrounddelete/config.yaml"
S3_BGDELETE_CONFIG_SAMPLE_FILE: "/opt/seagate/cortx/s3/s3backgrounddelete/config.yaml.sample"
S3_BGDELETE_CONFIG_UNSAFE_ATTR_FILE: "/opt/seagate/cortx/s3/s3backgrounddelete/s3backgrounddelete_unsafe_attributes.yaml"
S3_CLUSTER_CONFIG_FILE: "/opt/seagate/cortx/s3/s3backgrounddelete/s3_cluster.yaml"
S3_CLUSTER_CONFIG_SAMPLE_FILE: "/opt/seagate/cortx/s3/s3backgrounddelete/s3_cluster.yaml.sample"
S3_CLUSTER_CONFIG_UNSAFE_ATTR_FILE: "/opt/seagate/cortx/s3/s3backgrounddelete/s3_cluster_unsafe_attributes.yaml"


